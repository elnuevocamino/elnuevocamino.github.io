function createFieldElement(e){const t=e.type||e.tipo,n=e.options||e.opciones;if("table"===t)return createTableField(e);if("checkbox-group"===t)return createCheckboxGroup(e);const o=document.createElement("div");o.className="form-field","checkbox"===t&&o.classList.add("checkbox-field");const c=document.createElement("label");c.htmlFor=e.id,c.textContent=e.etiqueta,o.appendChild(c);const a=document.createElement("div");let l;switch(a.className="input-wrapper",t){case"textarea":l=document.createElement("textarea"),e.filas&&(l.rows=e.filas);break;case"select":if(l=document.createElement("select"),e.placeholder){const t=document.createElement("option");t.value="",t.textContent=e.placeholder,t.disabled=!0,t.selected=!0,l.appendChild(t)}n&&n.forEach(e=>{const t=document.createElement("option");t.value=e.value||e.valor,t.textContent=e.text||e.texto,e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),l.appendChild(t)});break;default:l=document.createElement("input"),l.type=t||"text"}if(l.id=e.id,l.name=e.id,e.placeholder&&(l.placeholder=e.placeholder),e.requerido&&(l.required=!0),a.appendChild(l),o.appendChild(a),e.tooltip){const n=createTooltip(e.tooltip);"checkbox"===t?o.appendChild(n):a.appendChild(n)}return o}function createTooltip(e){const t=document.createElement("div");t.className="tooltip";const n=document.createElement("i");n.className="tooltip-icon",n.textContent="i";const o=document.createElement("span");return o.className="tooltip-text",o.textContent=e,t.appendChild(n),t.appendChild(o),t}export function renderFormFromJSON(e,t){t.innerHTML="";const n=document.createElement("form");n.className="prompt-form",n.id=e.id,n.noValidate=!0,e.plantilla_prompt&&(n.dataset.promptTemplate=e.plantilla_prompt);const o=document.createDocumentFragment();e.campos.forEach(e=>{o.appendChild(createFieldElement(e))}),n.appendChild(o),t.appendChild(n)}function createTableField(e){const t=document.createElement("div");t.className="form-field";const n=document.createElement("label");n.textContent=e.etiqueta,t.appendChild(n);const o=document.createElement("div");o.className="input-wrapper";const c=document.createElement("div");c.className="table-control-container";const a=document.createElement("table");a.id=e.id,a.className="dynamic-table";const l=a.createTHead().insertRow();e.columnas.forEach(e=>{const t=document.createElement("th");t.textContent=e.etiqueta,l.appendChild(t)});const d=document.createElement("th");d.textContent="Acción",l.appendChild(d);const i=a.createTBody();addTableRow(i,e.id,e.columnas),c.appendChild(a);const r=document.createElement("button");if(r.type="button",r.textContent=e.texto_boton_anadir||"Añadir Fila",r.className="btn add-row-btn",r.addEventListener("click",()=>addTableRow(i,e.id,e.columnas)),c.appendChild(r),o.appendChild(c),e.tooltip){const t=createTooltip(e.tooltip);o.appendChild(t)}return t.appendChild(o),t}function addTableRow(e,t,n){const o=e.insertRow();let c=null;n.forEach(e=>{const t=o.insertCell();let n;const a=e.type||e.tipo,l=e.options||e.opciones;switch(a){case"checkbox":n=document.createElement("input"),n.type="checkbox";break;case"select":n=document.createElement("select"),l&&l.forEach(e=>{const t=document.createElement("option");t.value=e.value||e.valor,t.textContent=e.text||e.texto,e.selected&&(t.selected=!0),n.appendChild(t)});break;default:n=document.createElement("input"),n.type="text",n.placeholder=e.placeholder||""}n.dataset.columnId=e.id,e.requerido&&(n.required=!0),t.appendChild(n),c||(c=n)});const a=o.insertCell(),l=document.createElement("button");l.type="button",l.innerHTML="&times;",l.className="remove-row-btn",l.title="Eliminar fila",l.addEventListener("click",()=>{e.rows.length>1&&o.remove()}),a.appendChild(l),c&&c.focus()}function createCheckboxGroup(e){const t=document.createElement("div");t.className="form-field";const n=document.createElement("fieldset"),o=document.createElement("legend");o.className="form-label",o.textContent=e.etiqueta,n.appendChild(o);const c=e.options||e.opciones;return c&&c.forEach(t=>{const o=document.createElement("div");o.className="checkbox-option";const c=document.createElement("input");c.type="checkbox",c.id=`${e.id}-${(t.value||t.valor).replace(/\s+/g,"-")}`,c.name=e.id,c.value=t.value||t.valor,t.checked&&(c.checked=!0);const a=document.createElement("label");a.htmlFor=c.id,a.textContent=t.text||t.texto,o.append(c,a),n.appendChild(o)}),t.appendChild(n),t}